# !!! 所有内容均区分大小写 !!!

# 唯一标识
# 必填
# 生成工具：https://www.uuidgenerator.net/version7
uuid: cfee549f-e4d7-4574-b104-92d8251ebee4

# 原版物品
# 可选，默认 "stone"
material: wooden_sword

# 名字
# 可选，默认 "Unnamed"
display_name: "<red>Demo Short Sword"

# 描述
# 可选，默认 无
lore:
  - "<gold>Demo Lore 1"
  - "<gold>Demo Lore 2"

# 保养度
# 可选，默认 无
durability:
  # 临界值
  # 必填
  # 可写成正态分布的形式
  threshold: 512
  # 初始损耗
  # 可选，默认 0
  # 可写成正态分布的形式
  damage: 0

# 皮肤
# 可选，默认 无
# 如有设置，则物品自带预设的皮肤
# 这种情况下，皮肤的所有者为无
skin: demo_1

# 皮肤所有者
# 可选，默认 无
# 可以手动设置初始皮肤的所有者
# 必须写玩家的 UUID (Mojang)
skin_owner: 174eb4a8-20d1-4838-ab07-877cd1d68c14

# 等级
# 可选，默认 1
# 1. 如果写 "CRATE_LEVEL"，则根据盲盒的等级生成
# 2. 如果写 "ADVENTURE_LEVEL"，则根据玩家的冒险等级生成
# 3. 如果写 "EXPERIENCE_LEVEL"，则根据玩家的经验等级生成（原版经验等级）
# 4. 如果写 <正整数>，则始终以这里指定的物品等级生成
# 请注意，如果你采用 1/2/3，并不能保证等级就是你所期望的
# 如果选择 1，只有当物品通过盲盒开出来时，盲盒等级才会有效
# 如果选择 2/3，只有当物品直接通过玩家生成时，玩家等级才会有效
# 以上情况如果遇到无效等级，则会采用默认值 1
#level: CRATE_LEVEL
#level: ADVENTURE_LEVEL
level: EXPERIENCE_LEVEL
#level: 32

# 稀有度
# 可选，默认 首个稀有度
# 如果写 "mapping:<唯一标识>"，则根据唯一标识对应的映射生成
# 如果写 "rarity:<稀有度名>"，则始终以这里指定的稀有度生成
rarity: mapping:demo_1
#rarity: rarity:ancient

# 元素标识
# 可选，默认 无
elements:

  # 抽选 n 个元素作为该物品的元素标识
  sample: 2

  # 条件，可用于实现特定条件下完全不生成元素
  filters: [ ]

  # 候选的元素标识，以及它们各自的权重
  entries:
    - value: neutral
      weight: 2
    - value: water
      weight: 1
    - value: fire
      weight: 1
    - value: wind
      weight: 1

# 铭刻标识
# 可选，默认 无
kizami:
  pool_a:
    sample: 3
    filters:
      - type: rarity
        rarity: rare
    entries:
      - value: wood
        weight: 5
      - value: iron
        weight: 4
      - value: gold
        weight: 3
      - value: diamond
        weight: 2
      - value: netherite
        weight: 1
  pool_b:
    sample: 2
    filters:
      - type: rarity
        rarity: uncommon
    entries:
      - value: wood
        weight: 5
      - value: iron
        weight: 4
      - value: gold
        weight: 3
      - value: diamond
        weight: 2
      - value: netherite
        weight: 1
  pool_c:
    sample: 1
    filters:
      - type: rarity
        rarity: common
    entries:
      - value: wood
        weight: 5
      - value: iron
        weight: 4
      - value: gold
        weight: 3
      - value: diamond
        weight: 2
      - value: netherite
        weight: 1

# 词条栏
# 可选，默认 无
# 生成将按照该列表的顺序进行
cells:
  - id: a # 该词条栏的 id，在该物品的词条栏中必须唯一
    core: core_a # 该词条栏所使用的核心组 id，必须在 core_groups 有定义
    curse: curse_a # 该词条栏所使用的诅咒组 id，必须在 curse_groups 有定义
    keep_empty: false # 该词条栏在生成时如果没有核心被选中的话，是否在物品上保留空的词条栏
    # TODO 以下选项的具体用途等待开始写重铸系统时再决定，目前没有任何作用
    can_reforge: true # 该词条栏是否可重铸
    can_override: false # 该词条栏是否可以被玩家自由修改和覆盖
  - id: b
    core: core_b
    curse: curse_b
    keep_empty: false
    can_reforge: true
    can_override: false
  - id: c
    core: core_c
    curse: curse_c
    keep_empty: false
    can_reforge: true
    can_override: false
  - id: d
    # core: core_d # 核心组可以省略不写，表示该词条栏没有核心
    # curse: curse_d # ^^^
    keep_empty: true
    can_reforge: false
    can_override: false
  - id: e
    core: core_e
    curse: curse_e
    keep_empty: false
    can_reforge: false
    can_override: false
  - id: f
    core: core_f
    curse: curse_f
    keep_empty: true
    can_reforge: false
    can_override: false

# 核心池
#
# 这里定义的核心池只是数据，仅供核心组引用，单独自己没有实际作用（不会在物品上出现）
# 这些核心池需要在 core_groups.<group>.selects.<pool> 被引用才会产生实际作用
#
# 池也可以直接定义在组里，这里主要用来定义会反复使用的池，以避免写大量重复的配置
core_pools:

  # 这里定义了一个核心池
  # 其 id 为 shared_pool_1
  # 可以被 core_groups.<group>.selects.<pool> 引用
  shared_pool_1:

    # 进入该池需要满足的条件
    # 如果有多个条件 c1,c2,...,cn 意思是 AND(c1,c2,...,cn)
    # 写成 `[ ]` 或直接删除该节点，表示没有条件，也就是始终满足
    #
    # 如果条件不满足，则进入下一个满足条件的核心池
    #
    # 所有可用的条件将做单独说明，这里不再赘述
    filters: [ ]

    # 该池包含的所有核心
    entries:
      - key: attribute:max_health
        value: 20
        weight: 1

  # 定义的另一个核心池
  # 其 id 为 shared_pool_2
  shared_pool_2:
    filters: [ ]
    entries:
      - key: attribute:max_mana
        value: 100
        weight: 1
        filters: [ ]

# 核心组
core_groups:

  # 核心组：core_a
  # 这也是该核心组的 id，将被 cells.[].core 调用
  core_a:

    # 进入该核心组需要满足的条件
    # 如果有多个条件 c1,c2,...,cn 意思是 AND(c1,c2,...,cn)
    # 写成 `[ ]` 或直接删除该节点，表示没有条件，也就是始终满足
    #
    # 如果条件不满足，则没有核心生成
    filters: [ ]

    # 该核心组包含的所有核心池
    # 生成时，将进入第一个满足条件的池，然后生成内容
    # 这也意味着，条件越难的池应该写在越前面的位置
    #
    # 一旦进入一个池，将不会再退出然后再进入其他的池
    # 这意味着如果一个池内没有生成内容（例如由于核心自己的条件不满足），那么对应的词条栏也将没有内容
    selects:

      # 该核心组的一个候选池
      pool_1:
        filters:
          - type: rarity
            rarity: rare
        entries:
          - key: attribute:attack_damage

            # 修饰符的运算模式，可省略，默认为 add，可用值 multiply_base, multiply_total
            operation: add

            # 属性的元素
            element: neutral

            # 这是一个固定数值的写法，节点后直接跟数值
            lower: 15

            # 这是一个正态分布的写法，节点下需要创建新的缩进然后按格式编写
            upper:
              base: 30 # 正态分布的平均值
              scale: 0 # 等级加成，数值为 scale * level，可省略，默认为 0
              spread: 0.2 # 正态分布的标准差的“比例”
              min: -0.4 # 正态分布的最小“浮动比例”，可省略，默认为 -spread * 3
              max: 0.4 # 正态分布的最大“浮动比例，可省略，默认为 spread * 3

            # 该样本的权重
            weight: 1
          - key: attribute:critical_strike_chance
            value:
              base: 0.75
              spread: 0.1
              min: -0.2
              max: 0.3
            weight: 1
          - key: attribute:critical_strike_power
            value: 0.52
            weight: 1
            filters:
              - type: item_level
                level: "[20,)"

      # 该核心组的第二个候选池
      pool_2:
        filters:
          - type: rarity
            rarity: common
        entries:
          - key: attribute:attack_damage
            element: neutral
            lower: 10
            upper: 15
            weight: 1
          - key: attribute:critical_strike_chance
            value: 0.5
            weight: 1
          - key: attribute:critical_strike_power
            value: 0.25
            weight: 1
            filters:
              - type: item_level
                level: "[10,)"

    # 备用池，如果 selects 中没有满足条件的池，将使用备用池
    # 写成 `[ ]` 或直接删除该节点，表示没有备用池
    default:
      - key: attribute:attack_damage
        element: neutral
        lower: 5
        upper: 8
        weight: 1
      - key: attribute:critical_strike_chance
        value:
          base: 0.3
          scale: 0.1
        weight: 1

  # 核心组：core_b
  core_b:
    filters:
      - type: rarity
        rarity: common
    selects:
      pool_1: shared_pool_1 # 这里使用了 core_pools.shared_pool_1
    default: [ ]

  # 核心组：core_c
  core_c:
    filters: [ ]
    selects:
      pool_1: shared_pool_2 # 这里使用了 cire_pools.shared_pool_2
    default: [ ]

  # 核心组：core_d
  # 这是一个只有固定内容的词条栏的基本写法
  core_d:
    filters: [ ]
    selects: { }
    default:
      - key: attribute:lifesteal
        value: 0.2
        weight: 10
      - key: attribute:manasteal
        value: 0.21
        weight: 10

  # 核心组：core_e
  core_e:
    filters: [ ]
    selects:
      fire:
        filters:
          - type: element
            element: fire
        entries:
          - key: attribute:attack_damage
            element: fire
            lower: 10
            upper: 16
            weight: 8
          - key: attribute:attack_damage
            element: fire
            lower: 0.1
            upper: 0.1
            operation: multiply_base
            weight: 8
          - key: attribute:attack_effect_chance
            element: fire
            value: 0.38
            weight: 8
      water:
        filters:
          - type: element
            element: water
        entries:
          - key: attribute:attack_damage
            element: water
            lower: 10
            upper: 17
            weight: 8
          - key: attribute:attack_damage
            element: water
            lower: 0.2
            upper: 0.2
            operation: multiply_base
            weight: 8
          - key: attribute:attack_effect_chance
            element: water
            value: 0.42
            weight: 8
      wind:
        filters:
          - type: element
            element: wind
        entries:
          - key: attribute:attack_damage
            element: wind
            lower: 10
            upper: 18
            weight: 8
          - key: attribute:attack_damage
            element: wind
            lower: 0.3
            upper: 0.3
            operation: multiply_base
            weight: 8
          - key: attribute:attack_effect_chance
            element: wind
            value: 0.56
            weight: 8
    default: [ ] # 这里没有定义 fallback

  # 核心组：core_f
  core_f:
    filters: [ ]
    selects:
      ability:
        entries:
          - key: ability:blink
            weight: 1
          - key: ability:dash
            weight: 1
    default: [ ]

# 诅咒池
#
# 这里定义的诅咒池只是数据，仅供诅咒组引用，而无实际作用
# 这些诅咒池需要在 curse_groups.<group>.selects.<pool>
# 被引用才会产生实际作用（在物品上出现）
curse_pools:
  shared_pool_1:
    filters: [ ]
    entries:
      - key: curse:entity_kills
        index: demo_bosses_1
        count: 2
        weight: 1
      - key: curse:entity_kills
        index: demo_bosses_2
        count: 2
        weight: 1
      - key: curse:entity_kills
        index: demo_bosses_3
        count: 2
        weight: 1
  shared_pool_2:
    filters: [ ]
    entries:
      - key: curse:peak_damage
        amount: 20
        element: fire
        weight: 1
      - key: curse:peak_damage
        amount: 32
        element: water
        weight: 1

# 诅咒组
curse_groups:

  # 诅咒组：curse_a
  curse_a: # 该诅咒组的 id，将被 cells.[].curse 调用
    filters: [ ]
    selects:
      pool_1: shared_pool_1 # 这里引用了 curse_pools.shared_pool_1
    default:
      - key: curse:entity_kills
        index: demo_creeps_1
        count: 2
        weight: 1
      - key: curse:entity_kills
        index: demo_creeps_2
        count: 2
        weight: 1
      - key: curse:entity_kills
        index: demo_creeps_3
        count: 2
        weight: 1

  # 诅咒组：curse_b
  curse_b:
    filters: [ ]
    selects:
      pool_1: shared_pool_2 # 这里引用了 curse_pools.shared_pool_2
    default:
      - key: curse:peak_damage
        amount: 10
        element: fire
        weight: 1
      - key: curse:peak_damage
        amount: 16
        element: water
        weight: 1

  # 诅咒组：curse_c
  curse_c:
    filters: [ ]
    selects: { }
    default:
      - key: curse:peak_damage
        amount: 20
        element: fire
        weight: 1

  # 诅咒组：curse_d
  curse_d:
    filters: [ ]
    selects: { }
    default:
      - key: curse:peak_damage
        amount: 30
        element: water
        weight: 1

  # 诅咒组：curse_e
  curse_e:
    filters: [ ]
    selects: { }
    default:
      - key: curse:peak_damage
        amount: 40
        element: fire
        weight: 1

  # 诅咒组：curse_f
  curse_f:
    filters: [ ]
    selects: { }
    default:
      - key: curse:peak_damage
        amount: 50
        element: water
        weight: 1