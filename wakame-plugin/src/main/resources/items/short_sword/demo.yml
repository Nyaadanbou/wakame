# !!! 所有内容均区分大小写 !!!

# 唯一标识，生成工具：https://www.uuidgenerator.net/version4
uuid: cfee549f-e4d7-4574-b104-92d8251ebee4

# 原版物品
material: wooden_sword

# 名字
display_name: "<red>Demo"

# 描述
lore:
  - "<gold>Demo 1"
  - "<gold>Demo 2"

# 皮肤
# 如有设置，则物品自带预设的皮肤
# 这种情况下，皮肤的所有者为匿名
skin: demo_1

# 等级
# 如果写 "context"，则根据玩家的冒险等级生成
# 如果写 <正整数>，则始终以这里指定的物品等级生成
level: context

# 稀有度
# 如果写 "context"，则根据玩家的冒险等级生成
# 如果写 <稀有度名>，则始终以这里指定的稀有度生成
rarity: context

# 元素标识
elements:
  sample: 2 # 抽选 n 个元素作为该物品的元素标识
  entries: # 候选的元素标识，以及它们各自的权重
    - key: meta:element
      value: neutral
      weight: 2
    - key: meta:element
      value: water
      weight: 1
    - key: meta:element
      value: fire
      weight: 1
    - key: meta:element
      value: wind
      weight: 1

# 铭刻标识
kizami:
  sample: 2 # 抽选 n 个铭刻作为该物品的铭刻标识
  entries: # 候选的铭刻标识，以及它们各自的权重
    - id: meta:kizami
      value: iron
      weight: 2
    - id: meta:kizami
      value: gold
      weight: 1
    - id: meta:kizami
      value: diamond
      weight: 1
    - id: meta:kizami
      value: netherite
      weight: 1

# 词条栏
slots:
  - id: a # 该词条栏的 id，在该物品的词条栏中必须唯一
    content: group_a # 该词条栏所使用的词条组 id，词条将从组中的一个池中选择
    condition: group_a # 该词条栏所使用的条件组 id，条件将从组中的一个池中选择
    can_reforge: true # 该词条栏是否可重铸
    can_override: false # 该词条栏是否可以被玩家自由修改和覆盖
    keep_empty: false # 该词条栏在生成时如果没有词条被选中的话，是否在物品上保留空的词条栏
  - id: b
    content: group_b
    condition: group_b
    can_reforge: true
    can_override: false
    keep_empty: false
  - id: c
    content: group_c
    condition: group_c
    can_reforge: true
    can_override: false
    keep_empty: false
  - id: d
    content: group_d # TODO 词条组是不是也可以不写，表示这就是个空栏？
    # condition: group_c # 条件组可以省略不写，意思就是没有条件限制
    can_reforge: false
    can_override: false
    keep_empty: false
  - id: e
    content: group_e
    can_reforge: false
    can_override: false
    keep_empty: false
  - id: f
    content: group_f
    can_reforge: false
    can_override: false
    keep_empty: false

# 词条组
# 词条组将按照配置文件里的顺序，逐个生成内容，放入词条栏
slot_groups:

  # 词条组：group-a
  group_a: # 该词条组的 id
    conditions:
      - type: rarity
        rarity: common
    pools:
      pool_1: # 该词条组的一个候选池，取值必须在本堆中不重复
        conditions: # 进入该池需要满足的条件，如果有多个条件 c1,c2,cn 意思是 AND(c1,c2,cn)
          - type: rarity
            rarity: rare
        entries: # 该池拥有的所有词条
          - id: attribute:attack_damage
            weight: 1
            operation: add # 属性支持自定义操作模式 add(默认值), multiply_base, multiply_total
            element: neutral
            lower: 15 # 固定数值
            upper: # 随机数值
              base: 20 # 正态分布的平均值
              scale: 0 # 等级加成，数值为 scale * level，可省略，默认为 0
              spread: 0.2 # 正态分布的标准差
              max: 0.3 # 正态分布的最大标准差，可省略，默认为 spread * 2
          - id: attribute:critical_strike_chance
            weight: 1
            operation: add
            value: # 随机数值
              base: 0.75
              spread: 0.1
              max: 0.2
          - id: attribute:critical_strike_rate
            weight: 1
            operation: add
            value: 0.52 # 固定数值
            conditions: # 单独设置该词条的筛选条件，条件不满足则相当于该词条不存在于该池里
              - type: level # 这是一个关于物品等级要求的条件
                level: "[20,)" # 写整型范围，支持格式 (2,5], (2..5], (2,), [2..), [2..∞), [2,∞)
      pool_2:
        conditions:
          - type: rarity
            value: common
        entries:
          - id: attribute:attack_damage
            weight: 1
            element: neutral
            operation: add
            lower: 10
            upper: 15
          - id: attribute:critical_strike_chance
            weight: 1
            value: 0.5
          - id: attribute:critical_strike_rate
            weight: 1
            value: 0.25
            conditions:
              - type: item_level
                value: "[10,)"
    fallback: # 备用池，固定写成 fallback，如果 pools 中没有满足条件的 pool，将使用备用池
      - id: attribute:attack_damage
        weight: 1
        element: neutral
        lower: 5 # 固定数值
        upper: 8 # 固定数值
      - id: attribute:critical_strike_chance
        weight: 1
        value: # 随机数值
          base: 0.3
          scale: 0.1

  # 词条组：group-b
  group_b:
    conditions: [ ]
    pools:
      pool_1:
        conditions:
          - type: rarity
            value: rare
        entries:
          - id: attribute:attack_speed_level
            weight: 1
            value: 4
          - id: attribute:movement_speed_rate
            weight: 1
            value: 0.4
          - id: attribute:defense
            weight: 1
            value: 23
            meta: x1 # 为该项指定一个元数据（string），当该项被选中时，指定的元数据将被加入到上下文中
    fallback:
      - id: attribute:attack_speed_level
        weight: 1
        value: 2
      - id: attribute:movement_speed_rate
        weight: 1
        value: 0.2

  # 词条组：group-c
  group_c:
    conditions: [ ]
    pools:
      pool_1:
        conditions:
          - type: rarity
            value: rare
        entries:
          - id: attribute:max_health
            weight: 1
            value: 40
          - id: attribute:max_mana
            weight: 1
            value: 10
          - id: attribute:damage_reduction_rate
            weight: 99
            value: 0.25
            conditions:
              - type: context_meta # 该类型条件将检查物品生成的上下文中是否有指定的元数据存在
                value: x1 # 如果已经存在值为 x1 的元数据，则该项在随机选择前会被排除掉
    fallback:
      - id: attribute:max_health
        weight: 1
        value: 20
      - id: attribute:max_mana
        weight: 1
        value: 5

  # 词条组：group-d
  group_d:
    conditions: [ ]
    pools: { }
    fallback: # 这是一个只有固定内容的词条栏的基本写法
      - id: attribute:lifesteal
        weight: 10
        value: 0.2
      - id: attribute:manasteal
        weight: 10
        value: 0.21

  # 词条组：group-e
  group_e:
    conditions: [ ]
    pools:
      fire:
        conditions:
          - type: element
            value: fire
        entries:
          - id: attribute:attack_damage
            weight: 8
            element: fire
            lower: 10
            upper: 16
          - id: attribute:attack_damage_rate
            weight: 8
            element: fire
            value: 0.1
          - id: attribute:attack_effect_chance
            weight: 8
            element: fire
            value: 0.38
      water:
        conditions:
          - type: element
            value: water
        entries:
          - id: attribute:attack_damage
            weight: 8
            element: water
            lower: 10
            upper: 17
          - id: attribute:attack_damage_rate
            weight: 8
            element: water
            value: 0.2
          - id: attribute:attack_effect_chance
            weight: 8
            element: water
            value: 0.42
      wind:
        conditions:
          - type: element
            value: wind
        entries:
          - id: attribute:attack_damage
            weight: 8
            element: wind
            lower: 10
            upper: 18
          - id: attribute:attack_damage_rate
            weight: 8
            element: wind
            value: 0.3
          - id: attribute:attack_effect_chance
            weight: 8
            element: wind
            value: 0.56
    fallback: [ ] # 这里没有定义 fallback

  # 词条组：group-f
  group_f:
    conditions: [ ]
    pools:
      ability: # 这个池的 id
        entries:
          - id: ability:blink
            weight: 1
            mana: 12
            cooldown: 10
            distance: 16
          - id: ability:dash
            weight: 1
            mana: 12
            cooldown: 4
            damage: 8 * damage # 技能伤害为 8 倍的玩家所有元素伤害之和
    fallback: [ ]

# 词条栏的使用条件组
slot_condition_groups:

  # 自定义条件组：group-a
  group_a:
    pools:
      common:
        conditions:
          - type: rarity
            value: common
        entries:
          # TODO 条件的数值要不要也支持正态分布？如果要的话，那条件的数据就必须存在 NBT 里
          - id: count_boss_kills
            weight: 1
            entity: example_boss
            count: 1
          - id: count_creep_kills
            weight: 1
            entity: example_creep
            count: 3
    fallback:
      - id: count_boss_kills
        weight: 1
        entity: example_boss
        count: 2
      - id: count_creep_kills
        weight: 1
        entity: example_creep
        count: 6

  # 自定义条件组：group-b
  group_b:
    pools:
      common:
        conditions:
          - type: rarity
            value: common
        entries:
          - id: total_damage
            weight: 1
            source: fire
            amount: 100
    fallback:
      - id: total_damage
        weight: 1
        source: neutral
        amount: 100

  # 自定义条件组：group-c
  group_c:
    pools:
      common:
        conditions:
          - type: rarity
            value: common
        entries:
          - id: total_reforge_cost
            weight: 1
            cost: 2000
    fallback:
      - id: total_reforge_cost
        weight: 1
        cost: 4000
